<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:shiro="http://www.pollix.at/thymeleaf/shiro"
	th:replace="~{fragments/layout :: layout (~{::body},'db')}">
<head>

</head>
<body >
	<form class="form-horizontal" action="/editsave" method="post"
		id="form_sign">

		<div id="cover" class="cover" ></div>
		<div class="container">
			<div class="form-group">
				<input type="hidden" id="id" name="id" th:value="${user.id}"
					class="form-control">
			</div>
			<table class="table table-striped table-bordered">
			
				<tr class="form-group">
					<td>
					<div class="form-group">
					<label  id="nicknamespan" class="col-xs-3 control-label">用户名 ：</label > 
					<div class="col-xs-9">
				        <input type="text" id="nickname" name="nickname" th:value="${user.nickname}"
						class="form-control" placeholder="nickname" autofocus readonly>
					</div>
					</div>
					</td>
				</tr>
				
				<tr class="form-group">
					<td>
					<div class="form-group">
					<label id="reauth-email" class="col-xs-3 control-label">邮  箱 ：</label> 
					<div class="col-xs-9">
					<input type="email" id="email" name="email" th:value="${user.email}"
						class="form-control" placeholder="Email address" readonly>
				    </div>
				    </div>
					</td>
				</tr>

				<tr class="form-group">
					<td>
					<div class="form-group">
					<label class="col-xs-3 control-label">密  码 ：</label>
				    <div class="col-xs-9">
					<input type="text" id="pswd" name="pswd" th:value="${user.pswd}" class="form-control"
						placeholder="Password" readonly>
				</div>
				</div>
					</td>
				</tr>


				<!-- 签名区 -->
				<tr class="form-group" style="height: 125px">
					<td>
                       <div class="col-xs-2">
							<label id="sign-name">SIGN:</label>
						</div>
						<div class="col-xs-3" style="height: 125px">
							<button type="button" id="signname" class="btn btn-default"
								style="height: 120px;">签  名</button>
						</div> <!-- 任意显示框在此 -->
						<div class="col-xs-7">
							<div id="div1" class="div1"></div>
						</div>
                      </td>
					
				</tr>
			</table>
			
		</div>

		<!-- 签名框在此，先隐藏 -->
		<div id="signature-pad-parent" class="signature-pad-parent" style="display:none;">
			<div id="signature-pad" class="signature-pad text-center">
				<div class="signature-pad--body">
					<canvas></canvas>
				</div>
				<div class="signature-pad--footer">

					<div class="signature-pad--actions">
						<div>
							<!-- <button type="button" class="button clear" data-action="clear">Clear</button>
          <button type="button" class="button" data-action="change-color">Change color</button>
          <button type="button" class="button" data-action="undo">Undo</button>
          <button id="btnplayno" type="button" class="button save" data-action="save-img">签字</button> -->
							<a id="btnclear" data-action="clear">Clear</a> <a id="btnundo"
								data-action="undo">Undo</a> <a id="btnplayno"
								data-action="save-img">SignName</a>
						</div>
					</div>
				</div>
			</div>
		</div>
		<button class="btn btn-lg btn-primary btn-block btn-signin" id="save">保存</button>
		<button type="button" id="managerselect"
			class="btn btn-lg btn-primary btn-block btn-signin" shiro:hasRole="1">管理用户信息</button>

	</form>
	<script type="text/javascript">
		$("#save").bind("click", function() {
			var dataURL = signaturePad.toDataURL("image/jpeg");
			var blob = dataURLToBlob(dataURL);
			var formData = new FormData($("#form_sign")[0]);
			formData.append("blob", blob);
			$.ajax({
				url : '/jpgsave', // 自行按需配置好完整的url，包括ip和端口号  
				type : 'POST',
				data : formData,
				async : false,
				cache : false,
				contentType : false,
				processData : false,
				success : function(returndata) {
					alert("success");
				},
				error : function(returndata) {
					alert("error");
				}
			});
			window.location.href = "/editsave";
		});
	</script>

	<script type="text/javascript">
		//点击出现修改按钮
		var test1 = document.getElementById("nickname");
		var test2 = document.getElementById("email");
		var test3 = document.getElementById("pswd");
		var mysubmit = document.getElementById("save");
		test1.ondblclick = function() {
			this.readOnly = false;
			mysubmit.style.display = "";
		}
		test2.ondblclick = function() {
			this.readOnly = false;
			mysubmit.style.display = "";
		}
		test3.ondblclick = function() {
			this.readOnly = false;
			mysubmit.style.display = "";
		}
		mysubmit.onclick = function() {
			test1.readOnly = true;
			test2.readOnly = true;
			test3.readOnly = true;
			this.style.display = "none";
		}
		//管理者按钮
		$("#managerselect").bind("click", function() {
			window.location.href = "/managerselectall";
		});

		//页面加载先隐藏幕布和签名板
		 $(document).ready(function() {
			/* $(".cover").hide();
			$(".signature-pad-parent").hide(); */
			$(".cover").click(function() {
				$(".signature-pad-parent").hide();
				$(this).hide();
			});
		}) 
		
	
		//点击后两个显示
		$("#signname").bind("click", function() {
/* 			document.getElementById('cover').style.display='block';
			document.getElementById('signature-pad-parent').style.display='block';
			 */
			$(".cover").show();
			$(".signature-pad-parent").show().resize();
			
		});
		
		//签字后隐藏幕布
		$("#btnplayno").bind("click", function() {
			$(".cover").hide();
		});
	</script>
	<script src="js/signature_pad.js"></script>
	<script src="js/app.js"></script>
	<script th:src="@{/webjars/jquery/jquery.min.js}"></script>
	<script th:src="@{/webjars/jquery-ui/jquery-ui.min.js}"></script>
</body>

</html>
